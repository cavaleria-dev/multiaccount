# –§—Ä–∞–Ω—à–∏–∑–∞-—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ú–æ–π–°–∫–ª–∞–¥

[![Deploy Status](https://github.com/cavaleria-dev/multiaccount/actions/workflows/deploy.yml/badge.svg)](https://github.com/cavaleria-dev/multiaccount/actions)

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ç—å—é –¥–æ—á–µ—Ä–Ω–∏—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –ú–æ–π–°–∫–ª–∞–¥ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –≥–ª–∞–≤–Ω—ã–º –∏ –¥–æ—á–µ—Ä–Ω–∏–º–∏ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏ —Ñ—Ä–∞–Ω—à–∏–∑–Ω–æ–π —Å–µ—Ç–∏.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–æ–º** - –µ–¥–∏–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –≤—Å–µ–π —Å–µ—Ç–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** - —Ç–æ–≤–∞—Ä—ã, —Ü–µ–Ω—ã, –æ—Å—Ç–∞—Ç–∫–∏, –∑–∞–∫–∞–∑—ã
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—á–µ—Ä–Ω–∏–º–∏ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏** - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —É—Å–ª–æ–≤–∏—è–º
- **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å** - –µ–¥–∏–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –≤—Å–µ–π —Å–µ—Ç–∏ —Å —ç–∫—Å–ø–æ—Ä—Ç–æ–º –≤ Excel
- **–í–µ–±—Ö—É–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** - –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

**Backend:**
- PHP 8.4
- Laravel 11.x
- PostgreSQL 18
- Redis 7.x

**Frontend:**
- Vue 3
- Vite 5
- Tailwind CSS 3

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
- –ú–æ–π–°–∫–ª–∞–¥ JSON API 1.2
- –ú–æ–π–°–∫–ª–∞–¥ Vendor API 1.0
- –ú–æ–π–°–∫–ª–∞–¥ Webhook API

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- PHP 8.4+
- PostgreSQL 18+
- Redis 7+
- Node.js 22+
- Composer 2.x
- Nginx

## ‚ö° –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone git@github.com:cavaleria-dev/multiaccount.git
cd multiaccount
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# PHP –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
composer install

# JS –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cp .env.example .env

# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
php artisan key:generate

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env
nano .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```env
# Database
DB_DATABASE=moysklad_db
DB_USERNAME=moysklad_user
DB_PASSWORD=your_password

# –ú–æ–π–°–∫–ª–∞–¥ API
MOYSKLAD_APP_ID=your-app-id
MOYSKLAD_SECRET_KEY=your-secret-key
```

### 4. –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
php artisan migrate
```

### 5. –°–±–æ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

```bash
npm run build
```

### 6. –ó–∞–ø—É—Å–∫

```bash
# –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
php artisan serve
npm run dev  # –í –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ

# –î–ª—è production
# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä (Nginx/Apache) –Ω–∞ –ø–∞–ø–∫—É public/
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–≤

- [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è Claude](./docs/CLAUDE_INSTRUCTIONS.md)
- [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è ChatGPT](./docs/CHATGPT_INSTRUCTIONS.md)
- [–ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è Cursor AI](./.cursorrules)
- [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è GitHub Copilot](./.github/copilot-instructions.md)

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

**–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:**

1. **–¢–æ–≤–∞—Ä—ã: –ì–ª–∞–≤–Ω—ã–π ‚Üí –î–æ—á–µ—Ä–Ω–∏–µ**
   - –¢–æ–≤–∞—Ä—ã (products), –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ (variants), –∫–æ–º–ø–ª–µ–∫—Ç—ã (bundles)
   - –ê—Ç—Ä–∏–±—É—Ç—ã, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, —Ü–µ–Ω—ã, —à—Ç—Ä–∏—Ö–∫–æ–¥—ã
   - –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (customentity)
   - –ß–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥—å —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ –∏ –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏

2. **–ó–∞–∫–∞–∑—ã: –î–æ—á–µ—Ä–Ω–∏–µ ‚Üí –ì–ª–∞–≤–Ω—ã–π**
   - customerorder ‚Üí customerorder (–∑–∞–∫–∞–∑—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π)
   - retaildemand ‚Üí customerorder (—Ä–æ–∑–Ω–∏—á–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏)
   - purchaseorder ‚Üí customerorder (–∑–∞–∫–∞–∑—ã –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º, TODO)
   - –ù–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –±–µ–∑ –æ—á–µ—Ä–µ–¥–∏

**–û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:**

- `MoySkladService` - –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Ä–∞–±–æ—Ç–∞ —Å API, rate limit handling
- `ProductSyncService` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤, –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π, –∫–æ–º–ø–ª–µ–∫—Ç–æ–≤
- `CustomerOrderSyncService` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π
- `RetailDemandSyncService` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–æ–∑–Ω–∏—á–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂
- `CounterpartySyncService` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞–º–∏ —Ñ—Ä–∞–Ω—à–∏–∑
- `CustomEntitySyncService` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
- `BatchSyncService` - –º–∞—Å—Å–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –æ—á–µ—Ä–µ–¥—è–º–∏
- `WebhookService` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ–±—Ö—É–∫–∞–º–∏ –ú–æ–π–°–∫–ª–∞–¥
- `SyncStatisticsService` - —Å–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- `RateLimitHandler` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ª–∏–º–∏—Ç–æ–≤ API

**–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫:**
- `ProcessSyncQueueJob` - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—á–µ—Ä–µ–¥—å sync_queue –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ 50 –∑–∞–¥–∞—á –∑–∞ —Ä–∞–∑ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ –∏ –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö (exponential backoff)
- –û—Ç–ª–æ–∂–µ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏ rate limit

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ Http/Controllers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Api/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MoySkladController.php      # Vendor API endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ContextController.php       # –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ WebhookController.php           # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–µ–±—Ö—É–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ Services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MoySkladService.php             # –†–∞–±–æ—Ç–∞ —Å JSON API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RateLimitHandler.php            # Rate limit handling
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProductSyncService.php          # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CustomerOrderSyncService.php    # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RetailDemandSyncService.php     # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–¥–∞–∂
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CounterpartySyncService.php     # –ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CustomEntitySyncService.php     # –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CustomEntityService.php         # CRUD —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BatchSyncService.php            # –ú–∞—Å—Å–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ WebhookService.php              # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ–±—Ö—É–∫–∞–º–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SyncStatisticsService.php       # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ Jobs/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ProcessSyncQueueJob.php         # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—á–µ—Ä–µ–¥–∏
‚îÇ   ‚îî‚îÄ‚îÄ Models/
‚îÇ       ‚îú‚îÄ‚îÄ Account.php                     # –ê–∫–∫–∞—É–Ω—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ ChildAccount.php                # –°–≤—è–∑–∏ —Ñ—Ä–∞–Ω—à–∏–∑
‚îÇ       ‚îú‚îÄ‚îÄ SyncSetting.php                 # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
‚îÇ       ‚îú‚îÄ‚îÄ SyncQueue.php                   # –û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á
‚îÇ       ‚îú‚îÄ‚îÄ EntityMapping.php               # –ú–∞–ø–ø–∏–Ω–≥ —Å—É—â–Ω–æ—Å—Ç–µ–π
‚îÇ       ‚îú‚îÄ‚îÄ AttributeMapping.php            # –ú–∞–ø–ø–∏–Ω–≥ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ CharacteristicMapping.php       # –ú–∞–ø–ø–∏–Ω–≥ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
‚îÇ       ‚îú‚îÄ‚îÄ PriceTypeMapping.php            # –ú–∞–ø–ø–∏–Ω–≥ —Ç–∏–ø–æ–≤ —Ü–µ–Ω
‚îÇ       ‚îú‚îÄ‚îÄ CustomEntityMapping.php         # –ú–∞–ø–ø–∏–Ω–≥ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
‚îÇ       ‚îî‚îÄ‚îÄ SyncStatistics.php              # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ moysklad.php                        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ú–æ–π–°–∫–ª–∞–¥
‚îú‚îÄ‚îÄ database/migrations/                    # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î (30+ —Ñ–∞–π–ª–æ–≤)
‚îú‚îÄ‚îÄ resources/
‚îÇ   ‚îú‚îÄ‚îÄ js/                                 # Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ views/                              # Blade —à–∞–±–ª–æ–Ω—ã
‚îî‚îÄ‚îÄ routes/
    ‚îú‚îÄ‚îÄ api.php                             # API –º–∞—Ä—à—Ä—É—Ç—ã
    ‚îú‚îÄ‚îÄ web.php                             # Web –º–∞—Ä—à—Ä—É—Ç—ã
    ‚îî‚îÄ‚îÄ console.php                         # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á
```

### API Endpoints

#### Vendor API (–¥–ª—è –ú–æ–π–°–∫–ª–∞–¥)

```
PUT    /api/moysklad/vendor/1.0/apps/{appId}/{accountId}       # –£—Å—Ç–∞–Ω–æ–≤–∫–∞
DELETE /api/moysklad/vendor/1.0/apps/{appId}/{accountId}       # –£–¥–∞–ª–µ–Ω–∏–µ
GET    /api/moysklad/vendor/1.0/apps/{appId}/{accountId}/status # –°—Ç–∞—Ç—É—Å
```

#### Internal API

```
POST /api/apps/update-status            # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∏–∑ iframe
POST /api/webhooks/moysklad             # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–µ–±—Ö—É–∫–æ–≤
GET  /api/context/{contextKey}          # –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:**

**–ê–∫–∫–∞—É–Ω—Ç—ã –∏ —Å–≤—è–∑–∏:**
- `accounts` - –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (account_id, access_token, account_type)
- `child_accounts` - –°–≤—è–∑–∏ –≥–ª–∞–≤–Ω—ã–π‚Üî–¥–æ—á–µ—Ä–Ω–∏–π (—Å invitation_code, status)
- `accounts_archive` - –ê—Ä—Ö–∏–≤ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:**
- `sync_settings` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (30+ –ø–æ–ª–µ–π: —Ç–∏–ø—ã —Ü–µ–Ω, –∫–∞–Ω–∞–ª—ã –ø—Ä–æ–¥–∞–∂, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã, –∑–∞–¥–µ—Ä–∂–∫–∏)

**–û—á–µ—Ä–µ–¥–∏ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:**
- `sync_queue` - –û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (entity_type, operation, priority, scheduled_at)
- `entity_mappings` - –ú–∞–ø–ø–∏–Ω–≥ —Å—É—â–Ω–æ—Å—Ç–µ–π –º–µ–∂–¥—É –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏ (product, variant, bundle, customerorder, etc.)
- `attribute_mappings` - –ú–∞–ø–ø–∏–Ω–≥ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (–¥–æ–ø.–ø–æ–ª—è)
- `characteristic_mappings` - –ú–∞–ø–ø–∏–Ω–≥ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π
- `price_type_mappings` - –ú–∞–ø–ø–∏–Ω–≥ —Ç–∏–ø–æ–≤ —Ü–µ–Ω
- `custom_entity_mappings` - –ú–∞–ø–ø–∏–Ω–≥ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
- `custom_entity_element_mappings` - –ú–∞–ø–ø–∏–Ω–≥ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤

**–í–µ–±—Ö—É–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
- `webhook_health` - –ó–¥–æ—Ä–æ–≤—å–µ –≤–µ–±—Ö—É–∫–æ–≤ (is_active, last_check_at, check_attempts, error_message)
- `sync_statistics` - –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (success/failed counts, avg duration)

**–£—Å—Ç–∞—Ä–µ–≤—à–∏–µ —Ç–∞–±–ª–∏—Ü—ã:**
- `sync_logs` - –ñ—É—Ä–Ω–∞–ª –æ–ø–µ—Ä–∞—Ü–∏–π (—É—Å—Ç–∞—Ä–µ–ª–∞, –∑–∞–º–µ–Ω–µ–Ω–∞ –Ω–∞ sync_statistics)
- `webhooks` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤–µ–±—Ö—É–∫–æ–≤ (—É—Å—Ç–∞—Ä–µ–ª–∞, –∑–∞–º–µ–Ω–µ–Ω–∞ –Ω–∞ webhook_health)

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç API endpoint

```bash
curl -X GET "http://localhost:8000/api/moysklad/vendor/1.0/apps/test-app-id/test-account-id/status"
```

### –¢–µ—Å—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
php artisan tinker
>>> DB::table('accounts')->count();
```

## üö¢ –î–µ–ø–ª–æ–π

### GitHub Actions

–ü—Ä–æ–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è —á–µ—Ä–µ–∑ GitHub Actions –ø—Ä–∏ push –≤ –≤–µ—Ç–∫—É `main`.

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ Secrets:**
- `SERVER_HOST` - IP –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞
- `SERVER_USER` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å SSH
- `SSH_PRIVATE_KEY` - –ü—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /var/www/app.cavaleria.ru
./deploy.sh
```

## üìù –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞
php artisan cache:clear
php artisan config:clear
php artisan view:clear

# –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (production)
php artisan config:cache
php artisan route:cache
php artisan view:cache

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–æ—É—Ç–æ–≤
php artisan route:list

# –ú–∏–≥—Ä–∞—Ü–∏–∏
php artisan migrate
php artisan migrate:rollback
php artisan migrate:fresh  # –í–ù–ò–ú–ê–ù–ò–ï: —É–¥–∞–ª—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ!

# Frontend
npm run dev    # Development —Å hot reload
npm run build  # Production —Å–±–æ—Ä–∫–∞
```

### –†–∞–±–æ—Ç–∞ —Å Git

```bash
git status
git add .
git commit -m "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
git push origin main
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ production —Å–µ—Ä–≤–µ—Ä–∞

–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ CentOS 9 –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞.

**–û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏:**
1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PHP 8.4, PostgreSQL 18, Node.js 22
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx
3. SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç Let's Encrypt
4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Redis
5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–¥–µ–ø–ª–æ—è

## ü§ù –£—á–∞—Å—Ç–∏–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

1. Fork –ø—Ä–æ–µ–∫—Ç–∞
2. –°–æ–∑–¥–∞–π—Ç–µ feature –≤–µ—Ç–∫—É (`git checkout -b feature/AmazingFeature`)
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏–π (`git commit -m 'Add some AmazingFeature'`)
4. Push –≤ –≤–µ—Ç–∫—É (`git push origin feature/AmazingFeature`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–ø—Ä–∏–µ—Ç–∞—Ä–Ω—ã–º –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–º –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ–º.

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

**GitHub:** [cavaleria-dev](https://github.com/cavaleria-dev)  
**Email:** support@cavaleria.ru

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [–ú–æ–π–°–∫–ª–∞–¥ JSON API 1.2](https://dev.moysklad.ru/doc/api/remap/1.2/)
- [–ú–æ–π–°–∫–ª–∞–¥ Vendor API 1.0](https://dev.moysklad.ru/doc/api/vendor/1.0/)
- [Laravel Documentation](https://laravel.com/docs/11.x)
- [Vue 3 Documentation](https://vuejs.org/)
- [–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ú–æ–π–°–∫–ª–∞–¥](https://apps.moysklad.ru/cabinet/)

## üìã TODO

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∑–∞–¥–∞—á–∏
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å URL Vendor API –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ú–æ–π–°–∫–ª–∞–¥ (—Å–µ–π—á–∞—Å –∑–∞–ø—Ä–æ—Å—ã –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞ –∏–∑–≤–Ω–µ –¥–ª—è –ú–æ–π–°–∫–ª–∞–¥

### Backend
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã —Å –≤–µ–±—Ö—É–∫–∞–º–∏ (WebhookService, WebhookController)
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –∫–∞—Ç–∞–ª–æ–≥–∞ —Ç–æ–≤–∞—Ä–æ–≤ (ProductSyncService —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π –∏ –∫–æ–º–ø–ª–µ–∫—Ç–æ–≤)
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Ü–µ–Ω (–∞–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ —Ü–µ–Ω)
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –∑–∞–∫–∞–∑–æ–≤ (CustomerOrderSyncService, RetailDemandSyncService)
- [x] –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å API –ú–æ–π–°–∫–ª–∞–¥ (RateLimitException)
- [x] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ—á–µ—Ä–µ–¥–∏ (queues) –¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á (ProcessSyncQueueJob)
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ (CustomEntitySyncService)
- [x] –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (SyncStatisticsService)
- [ ] –î–æ–±–∞–≤–∏—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è `access_token` –≤ –ë–î
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –æ—Å—Ç–∞—Ç–∫–æ–≤
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ (DELETE webhooks)
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –¥–æ–ø.–ø–æ–ª—è–º –∏ –≥—Ä—É–ø–ø–∞–º

### Frontend
- [ ] –°–æ–∑–¥–∞—Ç—å –¥–∞—à–±–æ—Ä–¥ —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—á–µ—Ä–Ω–∏–º–∏ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏
- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –æ —Å—Ç–∞—Ç—É—Å–µ –¥–æ—á–µ—Ä–Ω–∏—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (suspended/uninstalled)
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ UI
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–æ–≤ –≤ Excel

### DevOps
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ GitHub Actions
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Sentry, LogRocket)
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö (Telegram, Email)
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ä–æ—Ç–∞—Ü–∏—é –ª–æ–≥–æ–≤ (logrotate)

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API
- [ ] –°–æ–∑–¥–∞—Ç—å –¥–∏–∞–≥—Ä–∞–º–º—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –ú–æ–π–°–∫–ª–∞–¥
- [ ] –î–æ–±–∞–≤–∏—Ç—å FAQ –ø–æ —á–∞—Å—Ç—ã–º –ø—Ä–æ–±–ª–µ–º–∞–º

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å integration —Ç–µ—Å—Ç—ã –¥–ª—è API
- [ ] –î–æ–±–∞–≤–∏—Ç—å end-to-end —Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤

---

**Status:** –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
**Version:** 1.0.0
**Last Update:** 13.10.2025